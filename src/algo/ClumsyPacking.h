#pragma once

#include "..\dings\dings.h"

class ClumsyPacking
{

public:
	typedef unsigned char NeighborConfiguration;

	static ClumsyPacking::NeighborConfiguration ClumsyPacking::ConfigurationFromNeighbors(bool nw, bool n, bool ne, bool e, bool se, bool s, bool sw, bool w)
	{
		return nw + (n << 1) + (ne << 2) + (e << 3) + (se << 4) + (s << 5) + (sw << 6) + (w << 7);
	}

	static ClumsyPacking::NeighborConfiguration ClumsyPacking::ConfigurationFromNeighbors(Facings theNeighbors)
	{
		return theNeighbors & 0x000000ff;
	}

	static Facings ClumsyPacking::FacingFromConfiguration(ClumsyPacking::NeighborConfiguration neighborConfig)
	{
		return ClumsyPacking::CLUMSY_PACKING[static_cast<unsigned>(neighborConfig)];
	}

	// The wonder of the clumsy packing of wang tiles in a 2-topology
	// See clumsypack.xlsx for illumination. this set has its own primes,
	// its own pi, and its own fine structure constant, probably
	static constexpr Facings ClumsyPacking::CLUMSY_PACKING[(unsigned)256]
	{
		Facings::Shy,
		Facings::Shy,
		Facings::South,
		Facings::South,
		Facings::Shy,
		Facings::Shy,
		Facings::South,
		Facings::South,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::Shy,
		Facings::Shy,
		Facings::South,
		Facings::South,
		Facings::Shy,
		Facings::Shy,
		Facings::South,
		Facings::South,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::EdgeNW,
		Facings::EdgeNW,
		Facings::TE,
		Facings::TE,
		Facings::EdgeNW,
		Facings::EdgeNW,
		Facings::EdgeCornerWD,
		Facings::EdgeCornerWD,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::EdgeNW,
		Facings::EdgeNW,
		Facings::EdgeCornerWU,
		Facings::EdgeCornerWU,
		Facings::EdgeNW,
		Facings::EdgeNW,
		Facings::EdgeW,
		Facings::EdgeW,
		Facings::Shy,
		Facings::Shy,
		Facings::North,
		Facings::North,
		Facings::Shy,
		Facings::Shy,
		Facings::North,
		Facings::North,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::Shy,
		Facings::Shy,
		Facings::South,
		Facings::South,
		Facings::Shy,
		Facings::Shy,
		Facings::South,
		Facings::South,
		Facings::West,
		Facings::West,
		Facings::EdgeCornerSW,
		Facings::EdgeCornerSW,
		Facings::West,
		Facings::West,
		Facings::EdgeSW,
		Facings::EdgeSW,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::EdgeCornerNW,
		Facings::EdgeCornerNW,
		Facings::TE,
		Facings::TE,
		Facings::EdgeCornerNW,
		Facings::EdgeCornerNW,
		Facings::EdgeCornerWD,
		Facings::EdgeCornerWD,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::North,
		Facings::North,
		Facings::NS,
		Facings::NS,
		Facings::EdgeNW,
		Facings::EdgeNW,
		Facings::EdgeCornerWU,
		Facings::EdgeCornerWU,
		Facings::EdgeNW,
		Facings::EdgeNW,
		Facings::EdgeW,
		Facings::EdgeW,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::WE,
		Facings::WE,
		Facings::TN,
		Facings::EdgeCornerSR,
		Facings::WE,
		Facings::WE,
		Facings::EdgeCornerSL,
		Facings::EdgeS,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::WE,
		Facings::WE,
		Facings::TN,
		Facings::EdgeCornerSR,
		Facings::WE,
		Facings::WE,
		Facings::EdgeCornerSL,
		Facings::EdgeS,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::WE,
		Facings::EdgeCornerED,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::WE,
		Facings::EdgeCornerED,
		Facings::TS,
		Facings::TS,
		Facings::Center,
		Facings::CornerSWNE,
		Facings::TS,
		Facings::TS,
		Facings::Corner3SW,
		Facings::Corner2S,
		Facings::EdgeCornerNE,
		Facings::EdgeCornerNE,
		Facings::TW,
		Facings::EdgeCornerED,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::TW,
		Facings::EdgeCornerED,
		Facings::EdgeCornerNL,
		Facings::EdgeCornerNL,
		Facings::Corner3NW,
		Facings::CornerSWNE,
		Facings::EdgeCornerNL,
		Facings::EdgeCornerNL,
		Facings::Corner2W,
		Facings::Corner1SW,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::WE,
		Facings::WE,
		Facings::TN,
		Facings::EdgeCornerSR,
		Facings::WE,
		Facings::WE,
		Facings::EdgeCornerSL,
		Facings::EdgeS,
		Facings::East,
		Facings::East,
		Facings::EdgeCornerSE,
		Facings::EdgeSE,
		Facings::East,
		Facings::East,
		Facings::EdgeSE,
		Facings::EdgeSE,
		Facings::WE,
		Facings::WE,
		Facings::TN,
		Facings::EdgeCornerSR,
		Facings::WE,
		Facings::WE,
		Facings::EdgeCornerSL,
		Facings::EdgeS,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::EdgeCornerEU,
		Facings::EdgeE,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::EdgeCornerEU,
		Facings::EdgeE,
		Facings::EdgeCornerNR,
		Facings::EdgeCornerNR,
		Facings::Corner3NE,
		Facings::Corner2E,
		Facings::EdgeCornerNR,
		Facings::EdgeCornerNR,
		Facings::CornerNWSE,
		Facings::Corner1SE,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::EdgeCornerEU,
		Facings::EdgeE,
		Facings::EdgeNE,
		Facings::EdgeNE,
		Facings::EdgeCornerEU,
		Facings::EdgeE,
		Facings::EdgeN,
		Facings::EdgeN,
		Facings::Corner2N,
		Facings::Corner1NE,
		Facings::EdgeN,
		Facings::EdgeN,
		Facings::Corner1NW,
		Facings::Immersed,
	};
};